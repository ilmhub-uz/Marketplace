@page "/CreateOrganization"
@using Marketplace.Organizations.Blazor.Models
@using System.Net.Http.Headers
@using Blazored.LocalStorage
@using Marketplace.Organizations.Blazor.Services

@inject NavigationManager Manager;
@inject CategoryServices CategoryServices;
<h3>CreateOrganization</h3>
<form class="row g-3" style="width: 400px ;margin: auto" enctype="multipart/form-data" >
    <div>
        <input @bind="@model.Name" class="form-control"  type="text" placeholder="Name"/>
    </div>
    <div>
        <input @bind="@model.Description"  class="form-control" type="text" placeholder="Description"/>
    </div>  
    <div>
        <InputFile OnChange="HandleFileSelected"   class="form-control"  type="file" placeholder="Logo"/>
    </div>  
    <div>
        <input @bind="@model.Contact"  class="form-control" type="text" placeholder="Contact"/>
    </div>
    <div>
            <input @bind="@_addressModel"  class="form-control" type="text" placeholder="Address"/>
        </div>
    <button class="form-control" type="button" @onclick="HandleFile" >AddOrganization</button>
</form>


@code {
    private CreateOrganizationModel model = new ();

    private string _addressModel = String.Empty;
    private void AddAddress()
    {
        if (model.Addresses == null)
        {
            model.Addresses = new List<CreateAddressModel>();
        }

        model.Addresses.Add(new CreateAddressModel { Address = _addressModel });
        _addressModel = string.Empty;
    }
    private async Task HandleFile()
    {
        AddAddress();
        CategoryServices.CreateOrganization(model);
    }
    private async Task HandleFileSelected(InputFileChangeEventArgs e)
    {
        model.Logo = e.File;
    }
}