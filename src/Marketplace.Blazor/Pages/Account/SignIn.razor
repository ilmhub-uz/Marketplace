@page "/signin"
@inject HttpClient Http
@inject ILocalStorageService storage
@inject NavigationManager manager;



@using System.Text.RegularExpressions
@using System.ComponentModel.DataAnnotations
@using Blazored.LocalStorage
@using Marketplace.Blazor.Models.AccountModel;

<h3>Login</h3>

<div style="margin:0 auto;width:50%;display:flex;justify-content:center; border-radius: 60px; box-shadow: 0 0 40px rgba(8,7,16,0.6);">
    <div>
        <form class="row g-3 " style="width: 400px " asp-controller="Users" asp-action="SignUp" enctype="multipart/form-data" method="post">
            <div style="margin-top:15px;">
                
               
                
                <div>
                    <input @bind="model.Username" class="form-control" type="text" placeholder="Username" />
                </div>
                <div>
                    <input @bind="model.Password" class="form-control" type="text" placeholder="Password" />
                </div>
            </div>

            <button class="form-control" type="button" @onclick="async () => await SignInUser()"> Sign Up</button>
            @* <a style="margin-bottom:15px;" class="link-info" asp-controller="Users" asp-action="SignIn">Sign In</a>*@
        </form>
    </div>
</div>

@code {


    LoginUserModel model = new LoginUserModel();



    private async Task SignInUser()
    {
        var response = await Http.PostAsJsonAsync("/account/login", model);
        var token = await response.Content.ReadAsStringAsync();
        await storage.SetItemAsStringAsync("token", token);

        manager.NavigateTo("/profile");
    }
}
